<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DVA ESCROW ¬∑ PAYMENT VERIFICATION SYSTEM</title>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(-45deg, #667eea, #764ba2, #6b8cff, #4a00e0);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            padding: 1.5rem;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
        }

        /* Left Panel - Forms */
        .left-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 48px;
            padding: 2rem;
            box-shadow: 0 30px 60px -20px rgba(0, 0, 0, 0.5);
        }

        /* Right Panel - Deals */
        .right-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 48px;
            padding: 2rem;
        }

        .header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(139, 92, 246, 0.2);
        }

        .logo {
            background: linear-gradient(145deg, #2b1b3a, #4a2b63);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .title h1 {
            font-size: 1.8rem;
            color: #2b1b3a;
        }

        .title p {
            color: #666;
            font-size: 0.9rem;
        }

        .live-badge {
            background: linear-gradient(145deg, #ffd700, #ffa500);
            padding: 0.5rem 1rem;
            border-radius: 40px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Role Selection */
        .role-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .role-btn {
            flex: 1;
            padding: 1rem;
            border: none;
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            background: #f3e8ff;
            color: #4a2b63;
        }

        .role-btn.active {
            background: linear-gradient(145deg, #8b5cf6, #6d28d9);
            color: white;
            box-shadow: 0 10px 20px -5px #8b5cf6;
        }

        /* Form Styles */
        .form-section {
            display: none;
        }

        .form-section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #4a2b63;
        }

        .form-group label i {
            margin-right: 0.5rem;
            color: #8b5cf6;
        }

        .form-control {
            width: 100%;
            padding: 0.8rem 1.2rem;
            border: 2px solid #e0d0ff;
            border-radius: 30px;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: #8b5cf6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
        }

        /* Payment Address Box */
        .payment-address {
            background: linear-gradient(145deg, #1e1b4b, #312e81);
            color: white;
            padding: 1.5rem;
            border-radius: 30px;
            margin: 1.5rem 0;
            text-align: center;
        }

        .address {
            font-size: 1.2rem;
            font-family: monospace;
            background: rgba(255,255,255,0.1);
            padding: 1rem;
            border-radius: 30px;
            margin: 1rem 0;
            word-break: break-all;
        }

        .copy-btn {
            background: #ffd700;
            color: #1e1b4b;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(255,215,0,0.3);
        }

        /* Photo Upload */
        .photo-upload {
            border: 3px dashed #8b5cf6;
            border-radius: 30px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin: 1.5rem 0;
        }

        .photo-upload:hover {
            background: #f3e8ff;
            transform: scale(1.02);
        }

        .photo-upload i {
            font-size: 3rem;
            color: #8b5cf6;
            margin-bottom: 1rem;
        }

        .photo-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .preview-image {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 20px;
            border: 3px solid #8b5cf6;
        }

        /* Submit Button */
        .submit-btn {
            width: 100%;
            padding: 1.2rem;
            background: linear-gradient(145deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 40px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 30px -10px #10b981;
        }

        /* Deals Grid */
        .deals-grid {
            display: grid;
            gap: 1.5rem;
            margin-top: 2rem;
            max-height: 700px;
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .deal-card {
            background: white;
            border-radius: 30px;
            padding: 1.5rem;
            border: 1px solid #e0d0ff;
            transition: all 0.3s;
        }

        .deal-card:hover {
            transform: translateX(5px);
            box-shadow: 0 10px 30px -10px #8b5cf6;
        }

        .deal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .deal-id {
            font-size: 1.2rem;
            font-weight: 700;
            color: #4a2b63;
        }

        .deal-status {
            padding: 0.4rem 1.2rem;
            border-radius: 40px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-pending { background: #fcd34d; color: #000; }
        .status-waiting { background: #93c5fd; color: #000; }
        .status-active { background: #4ade80; color: #000; }
        .status-completed { background: #8b5cf6; color: white; }
        .status-refunded { background: #f87171; color: white; }

        .deal-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin: 1rem 0;
        }

        .payment-proof {
            margin: 1rem 0;
            padding: 1rem;
            background: #f3e8ff;
            border-radius: 20px;
        }

        .proof-image {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
            border-radius: 20px;
            margin-top: 0.5rem;
        }

        .deal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .action-btn {
            flex: 1;
            padding: 0.8rem;
            border: none;
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            min-width: 120px;
        }

        .btn-release { background: #4ade80; color: #000; }
        .btn-refund { background: #f87171; color: white; }
        .btn-approve { background: #8b5cf6; color: white; }
        .btn-reject { background: #ef4444; color: white; }
        .btn-complete { background: #10b981; color: white; }
        .btn-pay { background: #f59e0b; color: #000; }

        .action-btn:hover {
            transform: translateY(-2px);
            filter: brightness(1.1);
            box-shadow: 0 10px 20px -5px currentColor;
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Seller Payment Address */
        .seller-payment {
            background: #f3e8ff;
            padding: 1rem;
            border-radius: 20px;
            margin: 1rem 0;
        }

        /* Notification */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(145deg, #10b981, #059669);
            color: white;
            padding: 1rem 2rem;
            border-radius: 60px;
            font-weight: 600;
            display: none;
            animation: slideIn 0.3s ease;
            z-index: 1000;
        }

        @keyframes slideIn {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Responsive */
        @media (max-width: 1000px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- LEFT PANEL - FORMS -->
        <div class="left-panel">
            <div class="header">
                <div class="logo">
                    <i class="fas fa-handshake"></i>
                </div>
                <div class="title">
                    <h1>DVA ESCROW</h1>
                    <p>Secure Payment System</p>
                </div>
                <div class="live-badge">
                    <i class="fas fa-circle" style="color: #4ade80;"></i> LIVE
                </div>
            </div>

            <!-- Role Selection -->
            <div class="role-selector">
                <button class="role-btn active" onclick="switchRole('buyer')" id="role-buyer">
                    <i class="fas fa-shopping-cart"></i> I'M BUYER
                </button>
                <button class="role-btn" onclick="switchRole('seller')" id="role-seller">
                    <i class="fas fa-store"></i> I'M SELLER
                </button>
            </div>

            <!-- BUYER FORM -->
            <div id="buyer-form" class="form-section active">
                <h3 style="color: #4a2b63; margin-bottom: 1.5rem;">
                    <i class="fas fa-shopping-cart"></i> BUYER PAYMENT FORM
                </h3>

                <form id="buyerDealForm">
                    <div class="form-group">
                        <label><i class="fas fa-user"></i> Your Username</label>
                        <input type="text" class="form-control" id="buyerUsername" placeholder="@username" required>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-user-tag"></i> Seller Username</label>
                        <input type="text" class="form-control" id="sellerUsername" placeholder="@seller" required>
                    </div>

                    <div class="currency-group" style="display: grid; grid-template-columns: 2fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label><i class="fas fa-dollar-sign"></i> Amount</label>
                            <input type="number" class="form-control" id="buyerAmount" placeholder="1000" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-coins"></i> Currency</label>
                            <select class="form-control" id="buyerCurrency">
                                <option value="USD">USD ($)</option>
                                <option value="ETB">ETB (·â•·à≠)</option>
                                <option value="EUR">EUR (‚Ç¨)</option>
                                <option value="GBP">GBP (¬£)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-box"></i> Item / Service</label>
                        <input type="text" class="form-control" id="buyerItem" placeholder="e.g., iPhone 13" required>
                    </div>

                    <!-- SELLER PAYMENT ADDRESS (auto-filled) -->
                    <div class="payment-address">
                        <i class="fas fa-building-columns" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <h4>SELLER'S PAYMENT ADDRESS</h4>
                        <div class="address" id="sellerPaymentAddress">
                            Bank: Chase Bank<br>
                            Account: 1234567890<br>
                            Name: John Seller<br>
                            Routing: 021000021
                        </div>
                        <button type="button" class="copy-btn" onclick="copyAddress()">
                            <i class="fas fa-copy"></i> COPY ADDRESS
                        </button>
                    </div>

                    <!-- PAYMENT PROOF PHOTO UPLOAD -->
                    <div class="photo-upload" onclick="document.getElementById('paymentProof').click()">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h4>CLICK TO UPLOAD PAYMENT PROOF</h4>
                        <p style="color: #666; font-size: 0.9rem;">Upload screenshot of payment</p>
                        <input type="file" id="paymentProof" accept="image/*" style="display: none;" onchange="previewImage(this)">
                    </div>

                    <!-- Image Preview -->
                    <div id="imagePreview" class="photo-preview"></div>

                    <button type="submit" class="submit-btn">
                        <i class="fas fa-paper-plane"></i> CONFIRM PAYMENT & SUBMIT
                    </button>
                </form>
            </div>

            <!-- SELLER FORM -->
            <div id="seller-form" class="form-section">
                <h3 style="color: #4a2b63; margin-bottom: 1.5rem;">
                    <i class="fas fa-store"></i> SELLER PAYMENT ADDRESS FORM
                </h3>

                <form id="sellerAddressForm">
                    <div class="form-group">
                        <label><i class="fas fa-user"></i> Your Username</label>
                        <input type="text" class="form-control" id="sellerUser" placeholder="@username" required>
                    </div>

                    <div class="payment-address" style="background: linear-gradient(145deg, #065f46, #047857);">
                        <i class="fas fa-building-columns" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <h4>ENTER YOUR PAYMENT ADDRESS</h4>
                        
                        <div class="form-group">
                            <label style="color: white;">Bank Name</label>
                            <input type="text" class="form-control" id="bankName" placeholder="e.g., Chase Bank" required>
                        </div>

                        <div class="form-group">
                            <label style="color: white;">Account Number</label>
                            <input type="text" class="form-control" id="accountNumber" placeholder="1234567890" required>
                        </div>

                        <div class="form-group">
                            <label style="color: white;">Account Holder Name</label>
                            <input type="text" class="form-control" id="accountName" placeholder="John Doe" required>
                        </div>

                        <div class="form-group">
                            <label style="color: white;">Routing Number (Optional)</label>
                            <input type="text" class="form-control" id="routingNumber" placeholder="021000021">
                        </div>

                        <div class="form-group">
                            <label style="color: white;">Additional Notes</label>
                            <textarea class="form-control" id="paymentNotes" rows="2" placeholder="Any special instructions..."></textarea>
                        </div>
                    </div>

                    <button type="submit" class="submit-btn">
                        <i class="fas fa-save"></i> SAVE PAYMENT ADDRESS
                    </button>
                </form>
            </div>
        </div>

        <!-- RIGHT PANEL - ACTIVE DEALS -->
        <div class="right-panel">
            <div class="header">
                <div class="logo" style="background: linear-gradient(145deg, #8b5cf6, #6d28d9);">
                    <i class="fas fa-list"></i>
                </div>
                <div class="title">
                    <h1>ACTIVE DEALS</h1>
                    <p>Real-time escrow updates</p>
                </div>
                <div class="live-badge">
                    <i class="fas fa-bolt"></i> 5 ACTIVE
                </div>
            </div>

            <!-- DEALS LIST -->
            <div class="deals-grid" id="dealsList">
                <!-- DEAL 1 - PENDING ADMIN APPROVAL -->
                <div class="deal-card" id="deal1">
                    <div class="deal-header">
                        <span class="deal-id">#DVA1251</span>
                        <span class="deal-status status-pending">PENDING ADMIN</span>
                    </div>
                    <div class="deal-details">
                        <div><i class="fas fa-user"></i> <strong>Buyer:</strong> @john_doe</div>
                        <div><i class="fas fa-store"></i> <strong>Seller:</strong> @joker_bv</div>
                        <div><i class="fas fa-dollar-sign"></i> <strong>Amount:</strong> $500 USD</div>
                        <div><i class="fas fa-box"></i> <strong>Item:</strong> iPhone 13</div>
                    </div>
                    
                    <!-- PAYMENT PROOF -->
                    <div class="payment-proof">
                        <strong><i class="fas fa-image"></i> PAYMENT PROOF UPLOADED:</strong>
                        <img src="https://via.placeholder.com/300x200/8b5cf6/ffffff?text=Payment+Proof" class="proof-image">
                    </div>

                    <!-- ADMIN ACTIONS -->
                    <div class="deal-actions">
                        <button class="action-btn btn-approve" onclick="approveDeal('deal1')">
                            <i class="fas fa-check"></i> APPROVE PAYMENT
                        </button>
                        <button class="action-btn btn-reject" onclick="rejectPayment('deal1')">
                            <i class="fas fa-times"></i> REJECT PAYMENT
                        </button>
                    </div>
                </div>

                <!-- DEAL 2 - ACTIVE (AWAITING SELLER RELEASE) -->
                <div class="deal-card" id="deal2">
                    <div class="deal-header">
                        <span class="deal-id">#DVA1248</span>
                        <span class="deal-status status-active">ACTIVE - AWAITING SELLER</span>
                    </div>
                    <div class="deal-details">
                        <div><i class="fas fa-user"></i> <strong>Buyer:</strong> @alice</div>
                        <div><i class="fas fa-store"></i> <strong>Seller:</strong> @blackxauu</div>
                        <div><i class="fas fa-coins"></i> <strong>Amount:</strong> 40 ETB</div>
                        <div><i class="fas fa-box"></i> <strong>Item:</strong> Gift Card</div>
                    </div>

                    <!-- SELLER PAYMENT ADDRESS -->
                    <div class="seller-payment">
                        <strong><i class="fas fa-building-columns"></i> SELLER'S PAYMENT ADDRESS:</strong>
                        <div style="margin-top: 0.5rem; font-family: monospace;">
                            Bank: Commercial Bank of Ethiopia<br>
                            Account: 100023456789<br>
                            Name: Black Xauu<br>
                            SWIFT: CBETETAA
                        </div>
                    </div>

                    <!-- SELLER ACTIONS -->
                    <div class="deal-actions">
                        <button class="action-btn btn-release" onclick="releaseFunds('deal2')">
                            <i class="fas fa-hand-holding-usd"></i> RELEASE FUNDS
                        </button>
                    </div>
                </div>

                <!-- DEAL 3 - ACTIVE (AWAITING BUYER REFUND) -->
                <div class="deal-card" id="deal3">
                    <div class="deal-header">
                        <span class="deal-id">#DVA1245</span>
                        <span class="deal-status status-active">ACTIVE - AWAITING BUYER</span>
                    </div>
                    <div class="deal-details">
                        <div><i class="fas fa-user"></i> <strong>Buyer:</strong> @agegnewu0102</div>
                        <div><i class="fas fa-store"></i> <strong>Seller:</strong> @amanu279</div>
                        <div><i class="fas fa-euro-sign"></i> <strong>Amount:</strong> ‚Ç¨50 EUR</div>
                        <div><i class="fas fa-box"></i> <strong>Item:</strong> Phone</div>
                    </div>

                    <!-- BUYER ACTIONS -->
                    <div class="deal-actions">
                        <button class="action-btn btn-refund" onclick="requestRefund('deal3')">
                            <i class="fas fa-undo-alt"></i> REQUEST REFUND
                        </button>
                    </div>
                </div>

                <!-- DEAL 4 - COMPLETED -->
                <div class="deal-card" id="deal4">
                    <div class="deal-header">
                        <span class="deal-id">#DVA1242</span>
                        <span class="deal-status status-completed">COMPLETED</span>
                    </div>
                    <div class="deal-details">
                        <div><i class="fas fa-user"></i> <strong>Buyer:</strong> @it_is_me_viva</div>
                        <div><i class="fas fa-store"></i> <strong>Seller:</strong> @liyu_7557</div>
                        <div><i class="fas fa-coins"></i> <strong>Amount:</strong> 1,040 ETB</div>
                        <div><i class="fas fa-box"></i> <strong>Item:</strong> Service</div>
                    </div>
                    <div style="color: #10b981; text-align: center; padding: 0.5rem;">
                        <i class="fas fa-check-circle"></i> Deal Completed Successfully
                    </div>
                </div>

                <!-- DEAL 5 - REFUNDED -->
                <div class="deal-card" id="deal5">
                    <div class="deal-header">
                        <span class="deal-id">#DVA1240</span>
                        <span class="deal-status status-refunded">REFUNDED</span>
                    </div>
                    <div class="deal-details">
                        <div><i class="fas fa-user"></i> <strong>Buyer:</strong> @kefafi3</div>
                        <div><i class="fas fa-store"></i> <strong>Seller:</strong> @joker_bv</div>
                        <div><i class="fas fa-dollar-sign"></i> <strong>Amount:</strong> $21 USD</div>
                        <div><i class="fas fa-box"></i> <strong>Item:</strong> Digital Code</div>
                    </div>
                    <div style="color: #ef4444; text-align: center; padding: 0.5rem;">
                        <i class="fas fa-undo-alt"></i> Refund Processed
                    </div>
                </div>
            </div>

            <!-- STATS SUMMARY -->
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-top: 2rem; padding-top: 1rem; border-top: 2px solid #e0d0ff;">
                <div style="text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: 700; color: #4a2b63;">193</div>
                    <div style="font-size: 0.8rem;">Total Deals</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: 700; color: #4a2b63;">$1.4K</div>
                    <div style="font-size: 0.8rem;">USD Volume</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: 700; color: #4a2b63;">120K</div>
                    <div style="font-size: 0.8rem;">ETB Volume</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: 700; color: #4a2b63;">9</div>
                    <div style="font-size: 0.8rem;">Admins</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i> Action completed!
    </div>

    <script>
        // ==================== ROLE SWITCHING ====================
        function switchRole(role) {
            // Update buttons
            document.getElementById('role-buyer').classList.remove('active');
            document.getElementById('role-seller').classList.remove('active');
            document.getElementById(`role-${role}`).classList.add('active');
            
            // Update forms
            document.getElementById('buyer-form').classList.remove('active');
            document.getElementById('seller-form').classList.remove('active');
            document.getElementById(`${role}-form`).classList.add('active');
        }

        // ==================== IMAGE PREVIEW ====================
        function previewImage(input) {
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = '';
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'preview-image';
                    preview.appendChild(img);
                    
                    showNotification('‚úÖ Payment proof uploaded!');
                }
                
                reader.readAsDataURL(input.files[0]);
            }
        }

        // ==================== COPY ADDRESS ====================
        function copyAddress() {
            const address = document.getElementById('sellerPaymentAddress').innerText;
            navigator.clipboard.writeText(address).then(() => {
                showNotification('‚úÖ Payment address copied!');
            });
        }

        // ==================== NOTIFICATION ====================
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // ==================== FORM SUBMISSIONS ====================
        
        // Buyer Form Submit
        document.getElementById('buyerDealForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const buyer = document.getElementById('buyerUsername').value;
            const seller = document.getElementById('sellerUsername').value;
            const amount = document.getElementById('buyerAmount').value;
            const currency = document.getElementById('buyerCurrency').value;
            const item = document.getElementById('buyerItem').value;
            
            // Create new deal card
            const dealsList = document.getElementById('dealsList');
            const dealId = 'DVA' + Math.floor(Math.random() * 1000);
            
            const newDeal = document.createElement('div');
            newDeal.className = 'deal-card';
            newDeal.innerHTML = `
                <div class="deal-header">
                    <span class="deal-id">#${dealId}</span>
                    <span class="deal-status status-pending">PENDING ADMIN</span>
                </div>
                <div class="deal-details">
                    <div><i class="fas fa-user"></i> <strong>Buyer:</strong> ${buyer}</div>
                    <div><i class="fas fa-store"></i> <strong>Seller:</strong> ${seller}</div>
                    <div><i class="fas fa-dollar-sign"></i> <strong>Amount:</strong> ${amount} ${currency}</div>
                    <div><i class="fas fa-box"></i> <strong>Item:</strong> ${item}</div>
                </div>
                <div class="payment-proof">
                    <strong><i class="fas fa-image"></i> PAYMENT PROOF UPLOADED:</strong>
                    <img src="${document.querySelector('#imagePreview img')?.src || 'https://via.placeholder.com/300x200/8b5cf6/ffffff?text=Payment+Proof'}" class="proof-image">
                </div>
                <div class="deal-actions">
                    <button class="action-btn btn-approve" onclick="approveDeal(this)">
                        <i class="fas fa-check"></i> APPROVE PAYMENT
                    </button>
                    <button class="action-btn btn-reject" onclick="rejectPayment(this)">
                        <i class="fas fa-times"></i> REJECT PAYMENT
                    </button>
                </div>
            `;
            
            dealsList.insertBefore(newDeal, dealsList.firstChild);
            
            showNotification('‚úÖ Deal submitted! Waiting for admin approval.');
            this.reset();
            document.getElementById('imagePreview').innerHTML = '';
        });

        // Seller Form Submit
        document.getElementById('sellerAddressForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const bank = document.getElementById('bankName').value;
            const account = document.getElementById('accountNumber').value;
            const name = document.getElementById('accountName').value;
            const routing = document.getElementById('routingNumber').value;
            
            // Update seller address in all deals
            const addressDivs = document.querySelectorAll('.seller-payment');
            addressDivs.forEach(div => {
                div.innerHTML = `
                    <strong><i class="fas fa-building-columns"></i> SELLER'S PAYMENT ADDRESS:</strong>
                    <div style="margin-top: 0.5rem; font-family: monospace;">
                        Bank: ${bank}<br>
                        Account: ${account}<br>
                        Name: ${name}<br>
                        ${routing ? 'Routing: ' + routing + '<br>' : ''}
                    </div>
                `;
            });
            
            showNotification('‚úÖ Payment address saved successfully!');
            this.reset();
        });

        // ==================== DEAL ACTIONS ====================
        
        // Admin approves payment
        function approveDeal(button) {
            const dealCard = button.closest('.deal-card');
            const dealId = dealCard.querySelector('.deal-id').innerText;
            
            // Update status
            dealCard.querySelector('.deal-status').innerText = 'ACTIVE - AWAITING SELLER';
            dealCard.querySelector('.deal-status').className = 'deal-status status-active';
            
            // Update actions for seller
            const actionsDiv = dealCard.querySelector('.deal-actions');
            actionsDiv.innerHTML = `
                <button class="action-btn btn-release" onclick="releaseFunds(this)">
                    <i class="fas fa-hand-holding-usd"></i> RELEASE FUNDS
                </button>
            `;
            
            // Add seller payment address if not exists
            if (!dealCard.querySelector('.seller-payment')) {
                const sellerPayment = document.createElement('div');
                sellerPayment.className = 'seller-payment';
                sellerPayment.innerHTML = `
                    <strong><i class="fas fa-building-columns"></i> SELLER'S PAYMENT ADDRESS:</strong>
                    <div style="margin-top: 0.5rem; font-family: monospace;">
                        Bank: Commercial Bank of Ethiopia<br>
                        Account: 100023456789<br>
                        Name: Seller Name<br>
                    </div>
                `;
                dealCard.insertBefore(sellerPayment, actionsDiv);
            }
            
            showNotification(`‚úÖ Deal ${dealId} approved! Waiting for seller.`);
        }

        // Admin rejects payment
        function rejectPayment(button) {
            const dealCard = button.closest('.deal-card');
            const dealId = dealCard.querySelector('.deal-id').innerText;
            
            dealCard.remove();
            showNotification(`‚ùå Deal ${dealId} rejected - Payment not verified`);
        }

        // Seller releases funds
        function releaseFunds(button) {
            const dealCard = button.closest('.deal-card');
            const dealId = dealCard.querySelector('.deal-id').innerText;
            
            // Update status
            dealCard.querySelector('.deal-status').innerText = 'COMPLETED';
            dealCard.querySelector('.deal-status').className = 'deal-status status-completed';
            
            // Remove actions
            dealCard.querySelector('.deal-actions').innerHTML = `
                <div style="color: #10b981; text-align: center; padding: 0.5rem; width: 100%;">
                    <i class="fas fa-check-circle"></i> Deal Completed Successfully
                </div>
            `;
            
            showNotification(`üí∞ Funds released! Deal ${dealId} completed.`);
        }

        // Buyer requests refund
        function requestRefund(button) {
            const dealCard = button.closest('.deal-card');
            const dealId = dealCard.querySelector('.deal-id').innerText;
            
            // Update status
            dealCard.querySelector('.deal-status').innerText = 'REFUNDED';
            dealCard.querySelector('.deal-status').className = 'deal-status status-refunded';
            
            // Update actions
            dealCard.querySelector('.deal-actions').innerHTML = `
                <div style="color: #ef4444; text-align: center; padding: 0.5rem; width: 100%;">
                    <i class="fas fa-undo-alt"></i> Refund Processed
                </div>
            `;
            
            showNotification(`üîÑ Refund processed for deal ${dealId}`);
        }

        // ==================== INIT ====================
        // Set buyer as default
        switchRole('buyer');
    </script>
</body>
</html>